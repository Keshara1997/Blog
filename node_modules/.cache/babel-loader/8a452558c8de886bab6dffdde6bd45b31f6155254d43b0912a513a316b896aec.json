{"ast":null,"code":"import _slicedToArray from\"C:/Users/Keshara1997/Downloads/Blogapp-using-MERN-main/Blogapp-using-MERN-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useCallback,useEffect}from'react';import'./App.css';import{Route,HashRouter as Router,Switch,Redirect}from'react-router-dom';import axios from'axios';import Auth from'./Components/Auth/Auth';import MainNavigation from'./Containers/Menubar/MainNavigation/MainNavigation';import Posts from'./Components/Posts/Posts';import SinglePost from'./Components/Posts/SinglePost/SinglePost';import{AuthContext}from'./context/auth-context';import CreatePost from'./Components/Posts/CreatePost/CreatePost';import Profile from'./Components/Users/Profile/Profile';import Mypost from'./Components/Posts/Mypost/Mypost';import CreateProfile from'./Components/Users/CreateProfile/CreateProfile';import Spinner from'./Containers/Spinner/Spinner';import Footer from'./Containers/footer/footer';import SocialMedia from'./Containers/SocialMedia.js/SocialMedia';var logoutTimer;var App=function App(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),tokenExpirationDate=_useState4[0],setTokenExpirationDate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsloading=_useState8[1];var login=useCallback(function(uid,token,expirationDate){setToken(token);setUserId(uid);setIsloading(false);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationDate(tokenExpirationDate);localStorage.setItem('userData',JSON.stringify({userId:uid,token:token,expiration:tokenExpirationDate.toISOString()}));axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);},[]);var logout=useCallback(function(){setToken(null);setTokenExpirationDate(null);setUserId(null);localStorage.removeItem('userData');localStorage.removeItem('profileData');var token=null;axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);},[]);useEffect(function(){if(token&&tokenExpirationDate){var remainingTime=tokenExpirationDate.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationDate]);useEffect(function(){var storedData=JSON.parse(localStorage.getItem('userData'));setIsloading(false);if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,new Date(storedData.expiration));}},[login]);var route;var loading;if(isLoading){loading=/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container loading\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mar-20\"},/*#__PURE__*/React.createElement(Spinner,null))));}else{route=/*#__PURE__*/React.createElement(React.Fragment,null,token?/*#__PURE__*/React.createElement(Route,{path:\"/create\",exact:true,component:CreatePost}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/createProfile\",exact:true,component:CreateProfile}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/edit/:id\",exact:true,component:CreatePost}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/mypost\",exact:true,component:Mypost}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/mypost/:id\",exact:true,component:SinglePost}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/profile\",exact:true,component:Profile}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}),token?/*#__PURE__*/React.createElement(Route,{path:\"/profile/edit/:id\",component:CreateProfile}):/*#__PURE__*/React.createElement(Redirect,{to:\"/auth\"}));}return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:{isLoggedIn:!!token,token:token,userId:userId,login:login,logout:logout}},/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(MainNavigation,null),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/post/:id\",exact:true,component:SinglePost}),/*#__PURE__*/React.createElement(Route,{path:\"/public/:id\",component:Profile}),/*#__PURE__*/React.createElement(Route,{path:\"/auth\",component:Auth,exact:true}),/*#__PURE__*/React.createElement(Route,{path:\"/\",component:Posts,exact:true}),route)),/*#__PURE__*/React.createElement(SocialMedia,null),/*#__PURE__*/React.createElement(Footer,null)),loading));};export default App;;","map":{"version":3,"names":["React","useState","useCallback","useEffect","Route","HashRouter","Router","Switch","Redirect","axios","Auth","MainNavigation","Posts","SinglePost","AuthContext","CreatePost","Profile","Mypost","CreateProfile","Spinner","Footer","SocialMedia","logoutTimer","App","props","_useState","_useState2","_slicedToArray","token","setToken","_useState3","_useState4","tokenExpirationDate","setTokenExpirationDate","_useState5","_useState6","userId","setUserId","_useState7","_useState8","isLoading","setIsloading","login","uid","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","defaults","headers","common","concat","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem","route","loading","createElement","Fragment","className","path","exact","component","to","Provider","value","isLoggedIn"],"sources":["C:/Users/Keshara1997/Downloads/Blogapp-using-MERN-main/Blogapp-using-MERN-main/src/App.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\n\nimport './App.css';\nimport {\n  Route,\n  HashRouter as Router,\n  Switch,\n  Redirect\n\n\n} from 'react-router-dom'\nimport axios from 'axios';\nimport Auth from './Components/Auth/Auth';\nimport MainNavigation from './Containers/Menubar/MainNavigation/MainNavigation';\nimport Posts from './Components/Posts/Posts';\nimport SinglePost from './Components/Posts/SinglePost/SinglePost';\nimport { AuthContext } from './context/auth-context'\nimport CreatePost from './Components/Posts/CreatePost/CreatePost';\nimport Profile from './Components/Users/Profile/Profile';\nimport Mypost from './Components/Posts/Mypost/Mypost';\nimport CreateProfile from './Components/Users/CreateProfile/CreateProfile'\n\nimport Spinner from './Containers/Spinner/Spinner';\nimport Footer from './Containers/footer/footer'\nimport SocialMedia from './Containers/SocialMedia.js/SocialMedia';\n\nlet logoutTimer;\n\nconst App = (props) => {\n\n\n  const [token, setToken] = useState(false);\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n  const [userId, setUserId] = useState(false);\n  const [isLoading, setIsloading] = useState(true)\n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    setIsloading(false)\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(tokenExpirationDate);\n    localStorage.setItem(\n      'userData',\n      JSON.stringify({\n        userId: uid,\n        token: token,\n        expiration: tokenExpirationDate.toISOString()\n      })\n    );\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    setTokenExpirationDate(null);\n    setUserId(null);\n    localStorage.removeItem('userData');\n    localStorage.removeItem('profileData');\n    let token = null\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime = tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    setIsloading(false)\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n\n  let route\n  let loading\n  if (isLoading) {\n    loading = (<>\n      <div className=\"container loading\">\n        <div className=\"mar-20\">\n          <Spinner />\n        </div>\n      </div>\n    </>)\n  }\n  else {\n    route = (<>\n      {token ? <Route path=\"/create\" exact component={CreatePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/createProfile\" exact component={CreateProfile}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/edit/:id\" exact component={CreatePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/mypost\" exact component={Mypost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/mypost/:id\" exact component={SinglePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/profile\" exact component={Profile} /> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/profile/edit/:id\" component={CreateProfile} /> : <Redirect to=\"/auth\" />}\n\n    </>\n    )\n  }\n  return (\n    <AuthContext.Provider\n      value={{\n        isLoggedIn: !!token,\n        token: token,\n        userId: userId,\n        login: login,\n        logout: logout\n      }}\n    >\n      <div className=\"App\">\n\n        <main>\n          <Router>\n            <MainNavigation />\n            <Switch>\n              <Route path=\"/post/:id\" exact component={SinglePost}></Route>\n              <Route path=\"/public/:id\" component={Profile} />\n              <Route path=\"/auth\" component={Auth} exact />\n              <Route path=\"/\" component={Posts} exact />\n              {route}\n\n            </Switch>\n          </Router>\n          <SocialMedia />\n          <Footer />\n        </main>\n        {loading}\n\n      </div>\n    </AuthContext.Provider>\n  );\n}\n\nexport default (App);;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}